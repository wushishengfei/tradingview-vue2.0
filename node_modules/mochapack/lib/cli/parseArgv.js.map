{"version":3,"sources":["../../src/cli/parseArgv.js"],"names":["parseArgv","BASIC_GROUP","OUTPUT_GROUP","ADVANCED_GROUP","options","alias","type","default","describe","group","colors","undefined","quiet","interactive","process","stdout","isTTY","growl","recursive","reporter","requiresArg","bail","glob","grep","fgrep","invert","require","multiple","include","slow","defaultDescription","timeout","ui","watch","exit","retries","delay","mode","choices","opts","paramList","parameters","parametersWithMultipleArgs","v","groupedAliases","value","key","filter","parse","argv","ignoreDefaults","parsedArgs","help","version","strict","files","_","length","parsedOptions","validOptions","Array","isArray","indexOf","arg","provided","map","join","expected","Error","reporterOptions","split","forEach","opt","L","webpackEnv","first","userOptions","providedKeys","usedAliases","aliases","push","origMainFilename","main","filename","resolve"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kBAkTwBA,S;;AAlTxB;;;;;;AAGA,IAAMC,cAAc,gBAApB;AACA,IAAMC,eAAe,iBAArB;AACA,IAAMC,iBAAiB,mBAAvB;;AAEA,IAAMC,UAAU;AACd,gBAAc;AACZC,WAAO,GADK;AAEZC,UAAM,SAFM;AAGZC,aAAS,KAHG;AAIZC,cAAU,gEAJE;AAKZC,WAAON;AALK,GADA;AAQdO,UAAQ;AACNL,WAAO,GADD;AAENC,UAAM,SAFA;AAGNC,aAASI,SAHH;AAINH,cAAU,0BAJJ;AAKNC,WAAOP;AALD,GARM;AAedU,SAAO;AACLP,WAAO,GADF;AAELC,UAAM,SAFD;AAGLC,aAASI,SAHJ;AAILH,cAAU,sCAJL;AAKLC,WAAOP;AALF,GAfO;AAsBdW,eAAa;AACXP,UAAM,SADK;AAEXC,aAAS,CAAC,CAAEO,QAAQC,MAAR,CAAeC,KAFhB;AAGXR,cAAU,sDAHC;AAIXC,WAAOP;AAJI,GAtBC;AA4Bd,oBAAkB;AAChBI,UAAM,SADU;AAEhBC,aAAS,KAFO;AAGhBC,cAAU,6CAHM;AAIhBC,WAAOP;AAJS,GA5BJ;AAkCde,SAAO;AACLZ,WAAO,GADF;AAELC,UAAM,SAFD;AAGLC,aAAS,KAHJ;AAILC,cAAU,mCAJL;AAKLC,WAAOP;AALF,GAlCO;AAyCdgB,aAAW;AACTZ,UAAM,SADG;AAETC,aAAS,KAFA;AAGTC,cAAU,yBAHD;AAITC,WAAON;AAJE,GAzCG;AA+CdgB,YAAU;AACRd,WAAO,GADC;AAERC,UAAM,QAFE;AAGRE,cAAU,6BAHF;AAIRC,WAAOP,YAJC;AAKRK,aAAS,MALD;AAMRa,iBAAa;AANL,GA/CI;AAuDd,sBAAoB;AAClBf,WAAO,GADW;AAElBC,UAAM,QAFY;AAGlBE,cAAU,+DAHQ;AAIlBC,WAAOP,YAJW;AAKlBkB,iBAAa;AALK,GAvDN;AA8DdC,QAAM;AACJhB,WAAO,GADH;AAEJC,UAAM,SAFF;AAGJE,cAAU,+BAHN;AAIJC,WAAON,cAJH;AAKJI,aAAS;AALL,GA9DQ;AAqEde,QAAM;AACJhB,UAAM,QADF;AAEJE,cAAU,qEAFN;AAGJC,WAAON,cAHH;AAIJiB,iBAAa;AAJT,GArEQ;AA2EdG,QAAM;AACJlB,WAAO,GADH;AAEJC,UAAM,QAFF;AAGJE,cAAU,mCAHN;AAIJC,WAAON,cAJH;AAKJiB,iBAAa;AALT,GA3EQ;AAkFdI,SAAO;AACLnB,WAAO,GADF;AAELC,UAAM,QAFD;AAGLE,cAAU,oCAHL;AAILC,WAAON,cAJF;AAKLiB,iBAAa;AALR,GAlFO;AAyFdK,UAAQ;AACNpB,WAAO,GADD;AAENC,UAAM,SAFA;AAGNE,cAAU,oCAHJ;AAINC,WAAON,cAJD;AAKNI,aAAS;AALH,GAzFM;AAgGdmB,WAAS;AACPrB,WAAO,GADA;AAEPC,UAAM,QAFC;AAGPE,cAAU,0BAHH;AAIPC,WAAON,cAJA;AAKPiB,iBAAa,IALN;AAMPO,cAAU;AANH,GAhGK;AAwGdC,WAAS;AACPtB,UAAM,QADC;AAEPE,cAAU,2CAFH;AAGPC,WAAON,cAHA;AAIPiB,iBAAa,IAJN;AAKPO,cAAU;AALH,GAxGK;AA+GdE,QAAM;AACJxB,WAAO,GADH;AAEJG,cAAU,uCAFN;AAGJC,WAAON,cAHH;AAIJI,aAAS,EAJL;AAKJuB,wBAAoB,OALhB;AAMJV,iBAAa;AANT,GA/GQ;AAuHdW,WAAS;AACP1B,WAAO,GADA;AAEPG,cAAU,uCAFH;AAGPC,WAAON,cAHA;AAIPI,aAAS,IAJF;AAKPuB,wBAAoB,SALb;AAMPV,iBAAa;AANN,GAvHK;AA+HdY,MAAI;AACF3B,WAAO,GADL;AAEFG,cAAU,gEAFR;AAGFC,WAAOR,WAHL;AAIFM,aAAS,KAJP;AAKFa,iBAAa;AALX,GA/HU;AAsIda,SAAO;AACL5B,WAAO,GADF;AAELC,UAAM,SAFD;AAGLE,cAAU,yBAHL;AAILC,WAAOR,WAJF;AAKLM,aAAS;AALJ,GAtIO;AA6Id,iBAAe;AACbD,UAAM,SADO;AAEbE,cAAU,iCAFG;AAGbC,WAAON,cAHM;AAIbI,aAAS;AAJI,GA7ID;AAmJd,gBAAc;AACZD,UAAM,SADM;AAEZE,cAAU,8BAFE;AAGZC,WAAON,cAHK;AAIZI,aAAS;AAJG,GAnJA;AAyJd,kBAAgB;AACdD,UAAM,SADQ;AAEdE,cAAU,+DAFI;AAGdC,WAAON,cAHO;AAIdI,aAAS;AAJK,GAzJF;AA+Jd2B,QAAM;AACJ5B,UAAM,SADF;AAEJE,cAAU,8EAFN;AAGJC,WAAON,cAHH;AAIJI,aAAS;AAJL,GA/JQ;AAqKd4B,WAAS;AACP3B,cAAU,iDADH;AAEPC,WAAOR,WAFA;AAGPmB,iBAAa;AAHN,GArKK;AA0KdgB,SAAO;AACL9B,UAAM,SADD;AAELE,cAAU,iCAFL;AAGLC,WAAON,cAHF;AAILI,aAAS;AAJJ,GA1KO;AAgLd8B,QAAM;AACJ/B,UAAM,QADF;AAEJgC,aAAS,CAAC,aAAD,EAAgB,YAAhB,CAFL;AAGJ9B,cAAU,qBAHN;AAIJC,WAAOR,WAJH;AAKJmB,iBAAa;AALT,GAhLQ;AAuLd,oBAAkB;AAChBd,UAAM,QADU;AAEhBE,cAAU,6BAFM;AAGhBC,WAAOR,WAHS;AAIhBmB,iBAAa,IAJG;AAKhBb,aAAS;AALO,GAvLJ;AA8Ld,iBAAe;AACbC,cAAU,iEADG;AAEbC,WAAOR;AAFM,GA9LD;AAkMdsC,QAAM;AACJjC,UAAM,QADF;AAEJE,cAAU,oCAFN;AAGJC,WAAOR,WAHH;AAIJmB,iBAAa;AAJT,GAlMQ;AAwMd,iBAAe;AACbd,UAAM,SADO;AAEbE,cAAU,uCAFG;AAGbC,WAAON,cAHM;AAIbI,aAAS;AAJI;AAxMD,CAAhB;;AAgNA,IAAMiC,YAAY,SAAZA,SAAY,CAACD,IAAD;AAAA,SAAU,mBAAM,oBAAOA,IAAP,CAAN,sBAAV;AAAA,CAAlB;AACA,IAAME,aAAaD,UAAUpC,OAAV,CAAnB,C,CAAuC;AACvC,IAAMsC,6BAA6BF,UAAU,sBAAS,yBAAYpC,OAAZ,EAAqB,UAACuC,CAAD;AAAA,SAAO,CAAC,CAACA,EAAEvB,WAAJ,IAAmBuB,EAAEhB,QAAF,KAAe,IAAzC;AAAA,CAArB,CAAT,CAAV,CAAnC,C,CAA6H;AAC7H,IAAMiB,iBAAiB,sBAAS,yBAAYxC,OAAZ,EAAqB,UAACyC,KAAD,EAAQC,GAAR;AAAA,SAAgB,CAAC,yBAAYA,GAAZ,CAAD,EAAmBA,GAAnB,EAAwBD,MAAMxC,KAA9B,EAAqC0C,MAArC,oBAAhB;AAAA,CAArB,CAAT,CAAvB,C,CAAgI;;AAEhI,SAASC,KAAT,CAAeC,IAAf,EAAqBC,cAArB,EAAqC;AACnC,MAAMC,aAAa,uBAChBC,IADgB,CACX,MADW,EAEhB/C,KAFgB,CAEV,MAFU,EAEF,GAFE,EAGhBgD,OAHgB,GAIhBjD,OAJgB,CAIRA,OAJQ,EAKhBkD,MALgB,GAMhBN,KANgB,CAMVC,IANU,CAAnB;;AAQA,MAAIM,QAAQJ,WAAWK,CAAvB;;AAEA,MAAI,CAACD,MAAME,MAAX,EAAmB;AACjBF,YAAQ,CAAC,QAAD,CAAR;AACD;;AAGD,MAAMG,gBAAgB,oBAAOP,UAAP,EAAmBV,UAAnB,CAAtB,CAhBmC,CAgBmB;AACtD,MAAMkB,eAAe,sBAASD,aAAT,wBAArB,CAjBmC,CAiB0B;;AAE7D,yBAAUhB,0BAAV,EAAsC,UAACI,GAAD,EAAS;AAC7C,QAAI,mBAAMa,YAAN,EAAoBb,GAApB,CAAJ,EAA8B;AAC5B,UAAMD,QAAQc,aAAab,GAAb,CAAd;AACA,UAAI,CAACc,MAAMC,OAAN,CAAchB,KAAd,CAAL,EAA2B;AACzBc,qBAAab,GAAb,IAAoB,CAACD,KAAD,CAApB;AACD;AACF;AACF,GAPD;;AASA,wBAASc,YAAT,EAAuB,UAACd,KAAD,EAAQC,GAAR,EAAgB;AACrC;AACA;AACA,QAAIJ,2BAA2BoB,OAA3B,CAAmChB,GAAnC,MAA4C,CAAC,CAA7C,IAAkD,uBAAUD,KAAV,CAAtD,EAAwE;AACtE,UAAMkB,MAAM,yBAAYjB,GAAZ,CAAZ;AACA,UAAMkB,WAAWnB,MAAMoB,GAAN,CAAU,UAACtB,CAAD;AAAA,sBAAYoB,GAAZ,SAAmBpB,CAAnB;AAAA,OAAV,EAAkCuB,IAAlC,CAAuC,GAAvC,CAAjB;AACA,UAAMC,kBAAgBJ,GAAhB,SAAuBlB,MAAM,CAAN,CAA7B;;AAEA,YAAM,IAAIuB,KAAJ,mCAA0CL,GAA1C,2BAAmEC,QAAnE,sCAA4GG,QAA5G,OAAN,CALsE,CAK0D;AACjI;AACF,GAVD;;AAYAR,eAAaJ,KAAb,GAAqBA,KAArB;;AAEA,MAAMc,kBAAkB,EAAxB;;AAEA,MAAIV,aAAaU,eAAjB,EAAkC;AAChCV,iBAAaU,eAAb,CAA6BC,KAA7B,CAAmC,GAAnC,EAAwCC,OAAxC,CAAgD,UAACC,GAAD,EAAS;AACvD,UAAMC,IAAID,IAAIF,KAAJ,CAAU,GAAV,CAAV;AACA,UAAIG,EAAEhB,MAAF,GAAW,CAAX,IAAgBgB,EAAEhB,MAAF,KAAa,CAAjC,EAAoC;AAClC,cAAM,IAAIW,KAAJ,8BAAqCI,GAArC,CAAN;AACD,OAFD,MAEO,IAAIC,EAAEhB,MAAF,KAAa,CAAjB,EAAoB;AACzBY,wBAAgBI,EAAE,CAAF,CAAhB,IAAwBA,EAAE,CAAF,CAAxB,CADyB,CACK;AAC/B,OAFM,MAEA;AACLJ,wBAAgBI,EAAE,CAAF,CAAhB,IAAwB,IAAxB;AACD;AACF,KATD;AAUD;;AAEDd,eAAaU,eAAb,GAA+BA,eAA/B;AACAV,eAAajC,OAAb,GAAuBiC,aAAajC,OAAb,IAAwB,EAA/C;AACAiC,eAAa/B,OAAb,GAAuB+B,aAAa/B,OAAb,IAAwB,EAA/C;;AAEA,MAAI+B,aAAae,UAAjB,EAA6B;AAC3B,6BAAYf,aAAae,UAAzB,EAAqC,UAAC7B,KAAD,EAAQC,GAAR,EAAgB;AACnD,UAAIc,MAAMC,OAAN,CAAchB,KAAd,CAAJ,EAA0B;AAAA,kDACRA,KADQ;AAAA,YACjB8B,KADiB;;AAExBhB,qBAAae,UAAb,CAAwB5B,GAAxB,IAA+B6B,KAA/B;AACD;AACF,KALD;AAMD;;AAED,MAAIzB,cAAJ,EAAoB;AAClB,QAAM0B,cAAc,qBAAM3B,IAAN,EAAYA,IAAhC;AACA,QAAM4B,eAAe,oBAAOD,WAAP,CAArB;AACA,QAAME,cAAc,uBAAU,sBAASlC,cAAT,EAAyB,UAACmC,OAAD;AAAA,aACrD,oBAAOA,OAAP,EAAgB,UAAC1E,KAAD;AAAA,eAAWwE,aAAaf,OAAb,CAAqBzD,KAArB,MAAgC,CAAC,CAA5C;AAAA,OAAhB,CADqD;AAAA,KAAzB,CAAV,CAApB;;AAGA,QAAI8C,WAAWK,CAAX,CAAaC,MAAjB,EAAyB;AACvBqB,kBAAYE,IAAZ,CAAiB,OAAjB;AACD;;AAED,WAAO,oBAAOrB,YAAP,EAAqBmB,WAArB,CAAP;AACD;;AAED,SAAOnB,YAAP;AACD;;AAEc,SAAS3D,SAAT,CAAmBiD,IAAnB,EAAiD;AAAA,MAAxBC,cAAwB,uEAAP,KAAO;;AAC9D,MAAM+B,mBAAmBvD,QAAQwD,IAAR,CAAaC,QAAtC;AACA,MAAI;AACF;AACA;AACAzD,YAAQwD,IAAR,CAAaC,QAAb,GAAwBzD,QAAQ0D,OAAR,CAAgB,kBAAhB,CAAxB;AACA,WAAOpC,MAAMC,IAAN,EAAYC,cAAZ,CAAP;AACD,GALD,SAKU;AACRxB,YAAQwD,IAAR,CAAaC,QAAb,GAAwBF,gBAAxB;AACD;AACF","file":"parseArgv.js","sourcesContent":["import yargs from 'yargs';\nimport _ from 'lodash';\n\nconst BASIC_GROUP = 'Basic options:';\nconst OUTPUT_GROUP = 'Output options:';\nconst ADVANCED_GROUP = 'Advanced options:';\n\nconst options = {\n  'async-only': {\n    alias: 'A',\n    type: 'boolean',\n    default: false,\n    describe: 'force all tests to take a callback (async) or return a promise',\n    group: ADVANCED_GROUP,\n  },\n  colors: {\n    alias: 'c',\n    type: 'boolean',\n    default: undefined,\n    describe: 'force enabling of colors',\n    group: OUTPUT_GROUP,\n  },\n  quiet: {\n    alias: 'q',\n    type: 'boolean',\n    default: undefined,\n    describe: 'does not show informational messages',\n    group: OUTPUT_GROUP,\n  },\n  interactive: {\n    type: 'boolean',\n    default: !!(process.stdout.isTTY),\n    describe: 'force interactive mode (default enabled in terminal)',\n    group: OUTPUT_GROUP,\n  },\n  'clear-terminal': {\n    type: 'boolean',\n    default: false,\n    describe: 'clear current terminal, purging its histroy',\n    group: OUTPUT_GROUP,\n  },\n  growl: {\n    alias: 'G',\n    type: 'boolean',\n    default: false,\n    describe: 'enable growl notification support',\n    group: OUTPUT_GROUP,\n  },\n  recursive: {\n    type: 'boolean',\n    default: false,\n    describe: 'include sub directories',\n    group: ADVANCED_GROUP,\n  },\n  reporter: {\n    alias: 'R',\n    type: 'string',\n    describe: 'specify the reporter to use',\n    group: OUTPUT_GROUP,\n    default: 'spec',\n    requiresArg: true,\n  },\n  'reporter-options': {\n    alias: 'O',\n    type: 'string',\n    describe: 'reporter-specific options, --reporter-options <k=v,k2=v2,...>',\n    group: OUTPUT_GROUP,\n    requiresArg: true,\n  },\n  bail: {\n    alias: 'b',\n    type: 'boolean',\n    describe: 'bail after first test failure',\n    group: ADVANCED_GROUP,\n    default: false,\n  },\n  glob: {\n    type: 'string',\n    describe: 'only test files matching <pattern> (only valid for directory entry)',\n    group: ADVANCED_GROUP,\n    requiresArg: true,\n  },\n  grep: {\n    alias: 'g',\n    type: 'string',\n    describe: 'only run tests matching <pattern>',\n    group: ADVANCED_GROUP,\n    requiresArg: true,\n  },\n  fgrep: {\n    alias: 'f',\n    type: 'string',\n    describe: 'only run tests containing <string>',\n    group: ADVANCED_GROUP,\n    requiresArg: true,\n  },\n  invert: {\n    alias: 'i',\n    type: 'boolean',\n    describe: 'inverts --grep and --fgrep matches',\n    group: ADVANCED_GROUP,\n    default: false,\n  },\n  require: {\n    alias: 'r',\n    type: 'string',\n    describe: 'require the given module',\n    group: ADVANCED_GROUP,\n    requiresArg: true,\n    multiple: true,\n  },\n  include: {\n    type: 'string',\n    describe: 'include the given module into test bundle',\n    group: ADVANCED_GROUP,\n    requiresArg: true,\n    multiple: true,\n  },\n  slow: {\n    alias: 's',\n    describe: '\"slow\" test threshold in milliseconds',\n    group: ADVANCED_GROUP,\n    default: 75,\n    defaultDescription: '75 ms',\n    requiresArg: true,\n  },\n  timeout: {\n    alias: 't',\n    describe: 'set test-case timeout in milliseconds',\n    group: ADVANCED_GROUP,\n    default: 2000,\n    defaultDescription: '2000 ms',\n    requiresArg: true,\n  },\n  ui: {\n    alias: 'u',\n    describe: 'specify user-interface (e.g. \"bdd\", \"tdd\", \"exports\", \"qunit\")',\n    group: BASIC_GROUP,\n    default: 'bdd',\n    requiresArg: true,\n  },\n  watch: {\n    alias: 'w',\n    type: 'boolean',\n    describe: 'watch files for changes',\n    group: BASIC_GROUP,\n    default: false,\n  },\n  'check-leaks': {\n    type: 'boolean',\n    describe: 'check for global variable leaks',\n    group: ADVANCED_GROUP,\n    default: false,\n  },\n  'full-trace': {\n    type: 'boolean',\n    describe: 'display the full stack trace',\n    group: ADVANCED_GROUP,\n    default: false,\n  },\n  'inline-diffs': {\n    type: 'boolean',\n    describe: 'display actual/expected differences inline within each string',\n    group: ADVANCED_GROUP,\n    default: false,\n  },\n  exit: {\n    type: 'boolean',\n    describe: 'require a clean shutdown of the event loop: mocha will not call process.exit',\n    group: ADVANCED_GROUP,\n    default: false,\n  },\n  retries: {\n    describe: 'set numbers of time to retry a failed test case',\n    group: BASIC_GROUP,\n    requiresArg: true,\n  },\n  delay: {\n    type: 'boolean',\n    describe: 'wait for async suite definition',\n    group: ADVANCED_GROUP,\n    default: false,\n  },\n  mode: {\n    type: 'string',\n    choices: ['development', 'production'],\n    describe: 'webpack mode to use',\n    group: BASIC_GROUP,\n    requiresArg: true,\n  },\n  'webpack-config': {\n    type: 'string',\n    describe: 'path to webpack-config file',\n    group: BASIC_GROUP,\n    requiresArg: true,\n    default: 'webpack.config.js',\n  },\n  'webpack-env': {\n    describe: 'environment passed to the webpack-config, when it is a function',\n    group: BASIC_GROUP,\n  },\n  opts: {\n    type: 'string',\n    describe: 'path to webpack-mocha options file',\n    group: BASIC_GROUP,\n    requiresArg: true,\n  },\n  'forbid-only': {\n    type: 'boolean',\n    describe: 'fail if exclusive test(s) encountered',\n    group: ADVANCED_GROUP,\n    default: false,\n  },\n};\n\nconst paramList = (opts) => _.map(_.keys(opts), _.camelCase);\nconst parameters = paramList(options); // camel case parameters\nconst parametersWithMultipleArgs = paramList(_.pickBy(_.mapValues(options, (v) => !!v.requiresArg && v.multiple === true))); // eslint-disable-line max-len\nconst groupedAliases = _.values(_.mapValues(options, (value, key) => [_.camelCase(key), key, value.alias].filter(_.identity))); // eslint-disable-line max-len\n\nfunction parse(argv, ignoreDefaults) {\n  const parsedArgs = yargs()\n    .help('help')\n    .alias('help', 'h')\n    .version()\n    .options(options)\n    .strict()\n    .parse(argv);\n\n  let files = parsedArgs._;\n\n  if (!files.length) {\n    files = ['./test'];\n  }\n\n\n  const parsedOptions = _.pick(parsedArgs, parameters); // pick all parameters as new object\n  const validOptions = _.omitBy(parsedOptions, _.isUndefined); // remove all undefined values\n\n  _.forEach(parametersWithMultipleArgs, (key) => {\n    if (_.has(validOptions, key)) {\n      const value = validOptions[key];\n      if (!Array.isArray(value)) {\n        validOptions[key] = [value];\n      }\n    }\n  });\n\n  _.forOwn(validOptions, (value, key) => {\n    // validate all non-array options with required arg that it is not duplicated\n    // see https://github.com/yargs/yargs/issues/229\n    if (parametersWithMultipleArgs.indexOf(key) === -1 && _.isArray(value)) {\n      const arg = _.kebabCase(key);\n      const provided = value.map((v) => `--${arg} ${v}`).join(' ');\n      const expected = `--${arg} ${value[0]}`;\n\n      throw new Error(`Duplicating arguments for \"--${arg}\" is not allowed. \"${provided}\" was provided, but expected \"${expected}\"`); // eslint-disable-line max-len\n    }\n  });\n\n  validOptions.files = files;\n\n  const reporterOptions = {};\n\n  if (validOptions.reporterOptions) {\n    validOptions.reporterOptions.split(',').forEach((opt) => {\n      const L = opt.split('=');\n      if (L.length > 2 || L.length === 0) {\n        throw new Error(`invalid reporter option ${opt}`);\n      } else if (L.length === 2) {\n        reporterOptions[L[0]] = L[1]; // eslint-disable-line prefer-destructuring\n      } else {\n        reporterOptions[L[0]] = true;\n      }\n    });\n  }\n\n  validOptions.reporterOptions = reporterOptions;\n  validOptions.require = validOptions.require || [];\n  validOptions.include = validOptions.include || [];\n\n  if (validOptions.webpackEnv) {\n    _.mapValues(validOptions.webpackEnv, (value, key) => {\n      if (Array.isArray(value)) {\n        const [first] = value;\n        validOptions.webpackEnv[key] = first;\n      }\n    });\n  }\n\n  if (ignoreDefaults) {\n    const userOptions = yargs(argv).argv;\n    const providedKeys = _.keys(userOptions);\n    const usedAliases = _.flatten(_.filter(groupedAliases, (aliases) =>\n      _.some(aliases, (alias) => providedKeys.indexOf(alias) !== -1)));\n\n    if (parsedArgs._.length) {\n      usedAliases.push('files');\n    }\n\n    return _.pick(validOptions, usedAliases);\n  }\n\n  return validOptions;\n}\n\nexport default function parseArgv(argv, ignoreDefaults = false) {\n  const origMainFilename = require.main.filename;\n  try {\n    // yargs searches for package.json up starting from `require.main.filename` path with `yargs` parser configuration\n    // it results in finding mocha `package.json` with config for yargs, which is different then we need\n    require.main.filename = require.resolve('../../bin/_mocha');\n    return parse(argv, ignoreDefaults);\n  } finally {\n    require.main.filename = origMainFilename;\n  }\n}\n"]}